# mise.sample.toml - Sample mise configuration for Claude skills management
#
# Add this to your ~/.config/mise/config.toml to enable skills management.
# Or run: ./install.sh
#
# All sync tasks run in dry-run mode by default.
# Use *-apply tasks or set apply=true in config file to actually sync.

[tasks.update-shared-skills]
description = "Update shared Claude skills repository"
run = """
SKILLS_REPO="${SKILLS_REPO:-https://github.com/takoeight0821/skills.git}"
SKILLS_DIR="${SKILLS_SHARED_DIR:-$HOME/.local/share/skills}"

if [ -d "$SKILLS_DIR" ]; then
  echo "Updating skills repository..."
  git -C "$SKILLS_DIR" pull --quiet
else
  echo "Cloning skills repository..."
  git clone "$SKILLS_REPO" "$SKILLS_DIR"
fi
echo "Done."
"""

# Global sync tasks (dry-run by default)
[tasks.sync-skills-global]
description = "Preview sync to ~/.claude/skills (dry-run)"
run = """
"${SKILLS_SHARED_DIR:-$HOME/.local/share/skills}/bin/sync-skills.sh" --global "$@"
"""

[tasks.sync-skills-global-apply]
description = "Sync shared skills to ~/.claude/skills"
run = """
"${SKILLS_SHARED_DIR:-$HOME/.local/share/skills}/bin/sync-skills.sh" --global --apply "$@"
"""

# Project sync tasks (dry-run by default)
[tasks.sync-skills-project]
description = "Preview sync to .claude/skills (dry-run)"
run = """
"${SKILLS_SHARED_DIR:-$HOME/.local/share/skills}/bin/sync-skills.sh" --project "$@"
"""

[tasks.sync-skills-project-apply]
description = "Sync shared skills to .claude/skills"
run = """
"${SKILLS_SHARED_DIR:-$HOME/.local/share/skills}/bin/sync-skills.sh" --project --apply "$@"
"""

# Optional: Auto-sync on entering a project directory
# Uncomment to enable (uses dry-run by default, set apply=true in config for auto-apply)
# [hooks]
# enter = "mise run sync-skills-project 2>/dev/null || true"

# =============================================================================
# Docker development environment tasks
# =============================================================================

[tasks.docker-build]
description = "Build the coding agent Docker image"
run = """
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
REPO_DIR="${SCRIPT_DIR}"
docker build -t coding-agent:latest -f "$REPO_DIR/docker/Dockerfile" "$REPO_DIR/docker/"
"""

[tasks.docker-up]
description = "Start the coding agent container"
run = """
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
REPO_DIR="${SCRIPT_DIR}"
"$REPO_DIR/docker/run.sh" up "$@"
"""

[tasks.docker-down]
description = "Stop the coding agent container"
run = """
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
REPO_DIR="${SCRIPT_DIR}"
"$REPO_DIR/docker/run.sh" down "$@"
"""

[tasks.docker-claude]
description = "Run Claude Code in the container"
run = """
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
REPO_DIR="${SCRIPT_DIR}"
"$REPO_DIR/docker/run.sh" claude "$@"
"""

[tasks.docker-gemini]
description = "Run Gemini CLI in the container"
run = """
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
REPO_DIR="${SCRIPT_DIR}"
"$REPO_DIR/docker/run.sh" gemini "$@"
"""

[tasks.docker-shell]
description = "Open a shell in the container"
run = """
SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
REPO_DIR="${SCRIPT_DIR}"
"$REPO_DIR/docker/run.sh" shell "$@"
"""
